{% extends "base.html" %}

{% block title %}Driver Dashboard - Rideshare Application{% endblock %}

{% block content %}
<h2 style="color: #667eea; margin-bottom: 30px;">Driver Dashboard</h2>

<div class="card" style="margin-bottom: 30px;">
    <h3>Profile Information</h3>
    <p><strong>Name:</strong> {{ user.full_name }}</p>
    <p><strong>Username:</strong> {{ user.username }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    {% if driver %}
    <p><strong>Vehicle:</strong> {{ driver.vehicle_year or 'N/A' }} {{ driver.vehicle_make or '' }} {{ driver.vehicle_model or '' }}</p>
    <p><strong>Driver Mode:</strong> 
        <span class="status-badge status-{{ driver.driver_mode }}">{{ driver.driver_mode.upper() }}</span>
    </p>
    {% endif %}
</div>

<div class="dashboard-grid">
    <div class="dashboard-card">
        <h3>View Rating</h3>
        <p style="margin: 15px 0;">See your average driver rating</p>
        <a href="{{ url_for('driver_rating') }}" class="btn">View Rating</a>
    </div>
    
    <div class="dashboard-card">
        <h3>View Rides</h3>
        <p style="margin: 15px 0;">See all your completed rides</p>
        <a href="{{ url_for('driver_rides') }}" class="btn">View Rides</a>
    </div>
    
    <div class="dashboard-card">
        <h3>Toggle Mode</h3>
        <p style="margin: 15px 0;">Activate or deactivate driver mode</p>
        <button onclick="toggleDriverMode()" class="btn" id="modeBtn">
            {{ 'Deactivate' if driver.driver_mode == 'active' else 'Activate' }} Mode
        </button>
    </div>
</div>

<script>
function toggleDriverMode() {
    fetch('{{ url_for("driver_toggle_mode") }}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const btn = document.getElementById('modeBtn');
            btn.textContent = data.mode === 'active' ? 'Deactivate Mode' : 'Activate Mode';
            location.reload();
        } else {
            alert('Failed to update driver mode');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred');
    });
}
</script>
{% endblock %}

